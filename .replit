run = "npm run start:prod"
build = "npm run build"
entrypoint = "src/main.tsx"

[env]
VITE_PORT = "5173"
VITE_PUBLIC_URL = "https://sheltr-ops.replit.app"
NODE_ENV = "production"
VITE_APP_ENV = "production"
VITE_ENABLE_MONITORING = "true"
VITE_SECURITY_MONITORING = "true"
PATH = "/home/runner/${REPL_SLUG}/node_modules/.bin:/home/runner/${REPL_SLUG}/node_modules/.bin:${PATH}"

[nix]
channel = "stable-23_11"

[deployment]
run = [
  "sh",
  "-c",
  "/nix/store/*/bin/npm ci --ignore-engines && npm run start:prod",
]
deploymentTarget = "cloudrun"
ignorePorts = false
publicDir = "dist"
build = [
  "sh",
  "-c",
  "/nix/store/*/bin/npm ci --ignore-engines && npm run build",
]
